# logon

Author: 孫逸平

Date: 2024-05-17

Link: https://play.picoctf.org/practice/challenge/46?category=1&page=1&search=logon

## 題目說明

The factory is hiding things from all of its users. Can you login as Joe and find what they've been looking at? https://jupiter.challenges.picoctf.org/problem/13594/ (link) or http://jupiter.challenges.picoctf.org:13594

## Write-up

1. 打開連結後發現是一個登入畫面，先任意輸入帳號密碼觀察，發現 Cookie 中的 admin 值為 Flase。
2. 嘗試將 Cookie 中的 admin 值改為 True 並重新整理，就得到 Flag 了：picoCTF{th3_c0nsp1r4cy_l1v3s_d1c24fef}。

## 防護說明與建議

### 本題 CWE

* CWE-639: Authorization Bypass Through User-Controlled Key
* CWE-284: Improper Access Control

### 建議防護與修補

* 使用 Session 進行管理

## 心得

這題是透過 Cookie 的值來修改權限，也是許多 CTF 題目常見的類型，這樣的問題會導致不安全的物件參照，可進行水平或垂直的越權，因此應避免使用這類簡易的驗證方式，而需進行加密或其他方式避免攻擊者的攻擊。題目中說要以 Joe 的身分登入，但我不太清楚這題跟 Joe 有什麼關聯。
